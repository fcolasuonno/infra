server {
    {% include "nginx/internal.j2" %}
    {% include "nginx/params.j2" %}
    server_name {{ web_applications['portainer']['url'] }};

    location / {
        {% include "nginx/cors.j2" %}

        include /config/nginx/proxy.conf;
        include /config/nginx/resolver.conf;
        set $upstream_app {{ web_applications['portainer']['ip_address'] }};
        set $upstream_port 9000;
        set $upstream_proto http;
        proxy_pass $upstream_proto://$upstream_app:$upstream_port;

    }

     location /api/websocket/ {
            {% include "nginx/cors.j2" %}

            include /config/nginx/proxy.conf;
            include /config/nginx/resolver.conf;
            set $upstream_app {{ web_applications['portainer']['ip_address'] }};
            set $upstream_port 9000;
            set $upstream_proto http;
            proxy_pass $upstream_proto://$upstream_app:$upstream_port;

     }
}
